<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pokémon Adventure XL</title>
  <link rel="icon" href="https://www.pngkey.com/png/full/222-2222875_pokedex-icon.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #f8f8f8;
      font-family: 'Press Start 2P', cursive;
      color: #000;
      overflow-y: scroll;
    }
    h1 {
      text-align: center;
      font-size: 1.2em;
      padding: 10px;
      background: #fff;
      border-bottom: 2px solid #000;
      user-select: none;
    }
    #game-box {
      max-width: 700px;
      margin: 20px auto 40px auto;
      background: #fff;
      border: 4px solid #000;
      padding: 20px;
      position: relative;
      min-height: 400px;
    }
    .dialogue-frame {
      background: url('https://www.nicepng.com/png/full/240-2406318_pokemon-text-box-pokmon.png') no-repeat center center;
      background-size: contain;
      padding: 60px 20px 60px 20px;
      min-height: 160px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      user-select: none;
    }
    .dialogue-text {
      font-size: 0.7em;
      line-height: 1.5;
      color: #000;
      max-width: 600px;
    }
    .sprite {
      width: 256px;
      height: 256px;
      image-rendering: pixelated;
      margin: 10px auto 20px auto;
      display: block;
      user-select: none;
      border: 4px solid #000;
      background: #fff;
      box-shadow: 0 0 10px #00000055 inset;
      border-radius: 8px;
      object-fit: contain;
    }
    .choices {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      user-select: none;
    }
    .choice-btn {
      background: #dcdcdc;
      border: 3px solid #000;
      padding: 14px;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.6em;
      cursor: pointer;
      transition: background 0.3s ease;
      border-radius: 6px;
      text-align: center;
      box-shadow: 2px 2px 0 #000;
    }
    .choice-btn:hover {
      background: #c0c0c0;
    }
    .branch {
      margin-top: 20px;
      font-size: 0.5em;
      border-left: 2px dashed #000;
      padding-left: 10px;
      max-height: 120px;
      overflow-y: auto;
      user-select: none;
      background: #f0f0f0;
      border-radius: 4px;
    }
    #volume-control {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #fff;
      border: 3px solid #000;
      border-radius: 10px;
      padding: 10px 15px;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.6em;
      user-select: none;
      box-shadow: 3px 3px 0 #000;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 8px;
      width: 180px;
    }
    #volume-control label {
      white-space: nowrap;
    }
    #volume-slider {
      flex-grow: 1;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>POKÉMON ADVENTURE XL</h1>
  <div id="game-box" role="main" aria-label="Game content">
    <img id="avatar" class="sprite" src="" alt="Sprite" />
    <div class="dialogue-frame" aria-live="polite" aria-atomic="true">
      <div class="dialogue-text" id="story-text"></div>
    </div>
    <div class="choices" id="choices" role="list"></div>
    <div class="branch" id="branch" aria-label="Choice history"></div>
  </div>

  <div id="volume-control" aria-label="Volume control">
    <label for="volume-slider">Volume</label>
    <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.3" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0.3" aria-label="Volume slider" />
  </div>

  <audio id="bg-audio" loop preload="auto" src="https://kappa.vgmsite.com/soundtracks/pokemon-firered-leafgreen-re-engineered-soundtrack-2004/hcdvftoyiy/35.%20Celadon%20City.mp3"></audio>

  <script>
    const animatedSprites = {
      bulbasaur: "https://projectpokemon.org/images/normal-sprite/bulbasaur.gif",
      charmander: "https://projectpokemon.org/images/normal-sprite/charmander.gif",
      squirtle: "https://projectpokemon.org/images/normal-sprite/squirtle.gif",
      pikachu: "https://projectpokemon.org/images/normal-sprite/pikachu.gif",
      rival: "https://projectpokemon.org/images/normal-sprite/rattata.gif"
    };

    const storyData = {
      start: {
        text: "You wake up in Pallet Town. Your adventure is about to begin!",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png",
        choices: [
          { text: "Visit Professor Oak to get a Pokémon", next: "oak" },
          { text: "Head north towards Route 1", next: "route1" },
          { text: "Talk to your mom before you leave", next: "mom" }
        ]
      },
      oak: {
        text: "Professor Oak: 'Welcome! It's time to choose your very first Pokémon!'",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png",
        choices: [
          { text: "Choose Bulbasaur, the grass-type", next: "bulbasaur" },
          { text: "Choose Charmander, the fire-type", next: "charmander" },
          { text: "Choose Squirtle, the water-type", next: "squirtle" },
        ]
      },
      bulbasaur: {
        text: "You chose Bulbasaur! As you turn to leave, your Rival, Blue, appears!",
        avatar: animatedSprites.bulbasaur,
        choices: [
          { text: "What does he want?", next: "rivalIntroCharmander" }
        ]
      },
      charmander: {
        text: "You chose Charmander! As you turn to leave, your Rival, Blue, appears!",
        avatar: animatedSprites.charmander,
        choices: [
          { text: "What does he want?", next: "rivalIntroSquirtle" }
        ]
      },
      squirtle: {
        text: "You chose Squirtle! As you turn to leave, your Rival, Blue, appears!",
        avatar: animatedSprites.squirtle,
        choices: [
          { text: "What does he want?", next: "rivalIntroBulbasaur" }
        ]
      },
      rivalIntroCharmander: {
        text: "Blue: 'You took Bulbasaur? I'll take this one then!' Blue chose Charmander. 'Let's battle!'",
        avatar: animatedSprites.rival,
        choices: [
          { text: "Battle Blue!", next: "battle" }
        ]
      },
      rivalIntroSquirtle: {
        text: "Blue: 'You took Charmander? I'll take this one then!' Blue chose Squirtle. 'Let's battle!'",
        avatar: animatedSprites.rival,
        choices: [
          { text: "Battle Blue!", next: "battle" }
        ]
      },
      rivalIntroBulbasaur: {
        text: "Blue: 'You took Squirtle? I'll take this one then!' Blue chose Bulbasaur. 'Let's battle!'",
        avatar: animatedSprites.rival,
        choices: [
          { text: "Battle Blue!", next: "battle" }
        ]
      },
      battle: {
        text: "The battle is intense! Your Pokémon is giving it its all!",
        avatar: animatedSprites.pikachu,
        choices: [
          { text: "Use your strongest attack!", next: "battleWin" },
          { text: "Try a defensive move...", next: "battleLose" }
        ]
      },
      battleWin: {
        text: "You won! Blue is frustrated but respects your strength. 'Hmph! Smell ya later!' He runs off.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/boulder-badge.png",
        choices: [
          { text: "Begin your journey on Route 1", next: "route1" }
        ]
      },
      battleLose: {
        text: "You lost, but your Pokémon grew stronger from the experience. Blue smirks, 'Heh! You're no match for me!' He runs off.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/40.png",
        choices: [
          { text: "Heal up and begin your journey on Route 1", next: "route1" }
        ]
      },
      route1: {
        text: "You're on Route 1. Tall grass rustles around you. The path to Viridian City is straight ahead.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/16.png",
        choices: [
          { text: "Walk in the tall grass", next: "grassEncounter" },
          { text: "Continue north to Viridian City", next: "viridian" }
        ]
      },
      grassEncounter: {
        text: "A wild Pidgey appears! It looks ready to battle.",
        avatar: "https://projectpokemon.org/images/normal-sprite/pidgey.gif",
        choices: [
          { text: "Try to catch it!", next: "catchSuccess" },
          { text: "Run away", next: "route1" }
        ]
      },
      catchSuccess: {
        text: "You caught the Pidgey! It's been added to your team.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png",
        choices: [
          { text: "Awesome! Keep exploring Route 1", next: "route1" }
        ]
      },
      mom: {
        text: "Mom: 'Be safe on your journey! Don't forget to change your underwear! Here's a Potion.'",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/39.png",
        choices: [
          { text: "Say thanks and leave", next: "start" },
        ]
      },
      viridian: {
        text: "You've arrived in Viridian City! It's much bigger than Pallet Town.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/133.png",
        choices: [
          { text: "Visit the Pokémon Center to heal", next: "pokeCenter" },
          { text: "Go to the Poké Mart", next: "pokeMart" },
          { text: "Challenge the Viridian Gym", next: "gymLocked" },
          { text: "Head west to Route 22", next: "route22" },
          { text: "Return to Pallet Town", next: "route1" }
        ]
      },
      pokeCenter: {
        text: "Nurse Joy: 'Welcome to the Pokémon Center! We've restored your Pokémon to full health.'",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/113.png",
        choices: [
          { text: "Thank Nurse Joy and exit", next: "viridian" }
        ]
      },
      gymLocked: {
        text: "You try to enter the Gym, but the door is locked. A sign says the leader is away.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/57.png",
        choices: [
          { text: "Oh well. Back to the city", next: "viridian" }
        ]
      },
      route22: {
        text: "Route 22 leads towards the Pokémon League. You can see a large building in the distance, but the path is blocked.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/22.png",
        choices: [
          { text: "Maybe I should train more first...", next: "viridian" }
        ]
      },
      pokeMart: {
        text: "The Poké Mart is stocked with Potions and Pokéballs.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/109.png",
        choices: [
          { text: "Buy Pokéballs", next: "buyPokeballs" },
          { text: "Leave the Mart", next: "viridian" }
        ]
      },
      buyPokeballs: {
        text: "You bought 5 Pokéballs. Now you're ready to catch more Pokémon!",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png",
        choices: [
          { text: "Leave the Mart", next: "viridian" }
        ]
      },
    };

    const avatarImg = document.getElementById('avatar');
    const storyText = document.getElementById('story-text');
    const choicesDiv = document.getElementById('choices');
    const branchDiv = document.getElementById('branch');
    const bgAudio = document.getElementById('bg-audio');
    const volumeSlider = document.getElementById('volume-slider');

    function loadStoryNode(nodeKey) {
      const node = storyData[nodeKey];
      if (!node) return;

      avatarImg.src = node.avatar;
      avatarImg.alt = "Sprite";
      storyText.textContent = node.text;

      choicesDiv.innerHTML = '';

      node.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.textContent = choice.text;
        btn.setAttribute('role', 'listitem');
        btn.onclick = () => {
          bgAudio.play().catch(() => {});
          loadStoryNode(choice.next);
          updateBranch(choice.text);
        };
        choicesDiv.appendChild(btn);
      });
    }

    function updateBranch(choiceText) {
      const p = document.createElement('p');
      p.textContent = "You chose: " + choiceText;
      branchDiv.appendChild(p);
      branchDiv.scrollTop = branchDiv.scrollHeight;
    }

    loadStoryNode('start');

    bgAudio.volume = volumeSlider.value;
    bgAudio.play().catch(() => {});

    volumeSlider.addEventListener('input', () => {
      bgAudio.volume = volumeSlider.value;
      bgAudio.play().catch(() => {});
      volumeSlider.setAttribute('aria-valuenow', volumeSlider.value);
    });
  </script>
</body>
</html>
