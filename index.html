<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pokémon Adventure XL</title>
  <link rel="icon" href="https://www.pngkey.com/png/full/222-2222875_pokedex-icon.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #f8f8f8;
      font-family: 'Press Start 2P', cursive;
      color: #000;
      overflow-y: scroll;
    }
    h1 {
      text-align: center;
      font-size: 1.2em;
      padding: 10px;
      background: #fff;
      border-bottom: 2px solid #000;
      user-select: none;
    }
    #game-box {
      max-width: 700px;
      margin: 20px auto 40px auto;
      background: #fff;
      border: 4px solid #000;
      padding: 20px;
      position: relative;
      min-height: 400px;
    }
    .dialogue-frame {
      background: url('https://www.nicepng.com/png/full/240-2406318_pokemon-text-box-pokmon.png') no-repeat center center;
      background-size: contain;
      padding: 60px 20px 60px 20px;
      min-height: 160px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      user-select: none;
    }
    .dialogue-text {
      font-size: 0.7em;
      line-height: 1.5;
      color: #000;
      max-width: 600px;
    }
    .sprite {
      width: 256px;
      height: 256px;
      image-rendering: pixelated;
      margin: 10px auto 20px auto;
      display: block;
      user-select: none;
      border: 4px solid #000;
      background: #fff;
      box-shadow: 0 0 10px #00000055 inset;
      border-radius: 8px;
      object-fit: contain;
    }
    .choices {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      user-select: none;
    }
    .choice-btn {
      background: #dcdcdc;
      border: 3px solid #000;
      padding: 14px;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.6em;
      cursor: pointer;
      transition: background 0.3s ease;
      border-radius: 6px;
      text-align: center;
      box-shadow: 2px 2px 0 #000;
    }
    .choice-btn:hover {
      background: #c0c0c0;
    }
    .branch {
      margin-top: 20px;
      font-size: 0.5em;
      border-left: 2px dashed #000;
      padding-left: 10px;
      max-height: 120px;
      overflow-y: auto;
      user-select: none;
      background: #f0f0f0;
      border-radius: 4px;
    }
    #volume-control {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #fff;
      border: 3px solid #000;
      border-radius: 10px;
      padding: 10px 15px;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.6em;
      user-select: none;
      box-shadow: 3px 3px 0 #000;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 8px;
      width: 180px;
    }
    #volume-control label {
      white-space: nowrap;
    }
    #volume-slider {
      flex-grow: 1;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>POKÉMON ADVENTURE XL</h1>
  <div id="game-box" role="main" aria-label="Game content">
    <img id="avatar" class="sprite" src="" alt="Sprite" />
    <div class="dialogue-frame" aria-live="polite" aria-atomic="true">
      <div class="dialogue-text" id="story-text"></div>
    </div>
    <div class="choices" id="choices" role="list"></div>
    <div class="branch" id="branch" aria-label="Choice history"></div>
  </div>

  <div id="volume-control" aria-label="Volume control">
    <label for="volume-slider">Volume</label>
    <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.3" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0.3" aria-label="Volume slider" />
  </div>

  <audio id="bg-audio" loop preload="auto" src="https://kappa.vgmsite.com/soundtracks/pokemon-firered-leafgreen-re-engineered-soundtrack-2004/hcdvftoyiy/35.%20Celadon%20City.mp3"></audio>

  <script>
    // Animated GIF URLs for starters and Pikachu from projectpokemon.org
    const animatedSprites = {
      bulbasaur: "https://projectpokemon.org/images/normal-sprite/bulbasaur.gif",
      charmander: "https://projectpokemon.org/images/normal-sprite/charmander.gif",
      squirtle: "https://projectpokemon.org/images/normal-sprite/squirtle.gif",
      pikachu: "https://projectpokemon.org/images/normal-sprite/pikachu.gif"
    };

    // Story data with animated sprites for starters and Pikachu
    const storyData = {
      start: {
        text: "You wake up in Pallet Town. What will you do?",
        avatar: animatedSprites.pikachu,
        choices: [
          { text: "Visit Professor Oak", next: "oak" },
          { text: "Walk into tall grass", next: "grass" },
          { text: "Check your Pokédex", next: "dex" },
          { text: "Talk to your mom", next: "mom" },
          { text: "Go to your room", next: "room" }
        ]
      },
      oak: {
        text: "Professor Oak offers you a starter Pokémon. Choose wisely!",
        avatar: animatedSprites.bulbasaur,
        choices: [
          { text: "Choose Bulbasaur", next: "bulbasaur" },
          { text: "Choose Charmander", next: "charmander" },
          { text: "Choose Squirtle", next: "squirtle" },
          { text: "Ask for Pikachu", next: "pikachu" },
          { text: "Decline and leave", next: "leaveLab" }
        ]
      },
      grass: {
        text: "A wild Pikachu appears! It looks ready to battle.",
        avatar: animatedSprites.pikachu,
        choices: [
          { text: "Throw Pokéball", next: "catch" },
          { text: "Run away", next: "run" },
          { text: "Battle it", next: "battle" },
          { text: "Offer berries", next: "berries" }
        ]
      },
      dex: {
        text: "Your Pokédex shows 4 Pokémon registered: Bulbasaur, Charmander, Squirtle, and Pikachu.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png",
        choices: [
          { text: "Go back", next: "start" }
        ]
      },
      mom: {
        text: "Your mom gives you a potion and wishes you luck on your journey.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/39.png",
        choices: [
          { text: "Say thanks", next: "start" },
          { text: "Ask for lunch", next: "lunch" }
        ]
      },
      room: {
        text: "You find your old Pokégear and a map. The world awaits!",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/52.png",
        choices: [
          { text: "Check the map", next: "map" },
          { text: "Go back outside", next: "start" }
        ]
      },
      lunch: {
        text: "You eat a delicious sandwich and feel energized for your adventure.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/143.png",
        choices: [
          { text: "Back to town", next: "start" }
        ]
      },
      map: {
        text: "The map shows Viridian City to the north and Mt. Moon to the east.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png",
        choices: [
          { text: "Head to Viridian City", next: "viridian" },
          { text: "Explore Mt. Moon", next: "mtMoon" },
          { text: "Back to town", next: "start" }
        ]
      },
      viridian: {
        text: "Viridian City is bustling with trainers and shops. You feel excited.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png",
        choices: [
          { text: "Visit the Poké Mart", next: "pokeMart" },
          { text: "Challenge the Gym", next: "gym" },
          { text: "Return to Pallet Town", next: "start" }
        ]
      },
      mtMoon: {
        text: "Mt. Moon is dark and mysterious. You hear strange noises.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/95.png",
        choices: [
          { text: "Explore deeper", next: "cave" },
          { text: "Turn back", next: "map" }
        ]
      },
      pokeMart: {
        text: "The Poké Mart is stocked with potions, Pokéballs, and more.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png",
        choices: [
          { text: "Buy a Potion", next: "buyPotion" },
          { text: "Buy Pokéballs", next: "buyPokeballs" },
          { text: "Leave the Mart", next: "viridian" }
        ]
      },
      gym: {
        text: "The Gym Leader awaits. Are you ready for the challenge?",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/56.png",
        choices: [
          { text: "Battle the Gym Leader", next: "gymBattle" },
          { text: "Train more", next: "train" },
          { text: "Leave the Gym", next: "viridian" }
        ]
      },
      buyPotion: {
        text: "You bought a Potion. It might come in handy.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/potion.png",
        choices: [
          { text: "Buy more", next: "pokeMart" },
          { text: "Leave the Mart", next: "viridian" }
        ]
      },
      buyPokeballs: {
        text: "You bought some Pokéballs. Ready to catch more Pokémon!",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png",
        choices: [
          { text: "Buy more", next: "pokeMart" },
          { text: "Leave the Mart", next: "viridian" }
        ]
      },
      gymBattle: {
        text: "You battle the Gym Leader and win! You earned a badge!",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/56.png",
        choices: [
          { text: "Celebrate", next: "celebrate" },
          { text: "Continue journey", next: "final" }
        ]
      },
      train: {
        text: "You train hard and your Pokémon grow stronger.",
        avatar: animatedSprites.pikachu,
        choices: [
          { text: "Battle the Gym Leader", next: "gymBattle" },
          { text: "Keep training", next: "train" },
          { text: "Leave the Gym", next: "viridian" }
        ]
      },
      celebrate: {
        text: "You celebrate your victory with friends and prepare for new adventures.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png",
        choices: [
          { text: "Continue journey", next: "final" }
        ]
      },
      cave: {
        text: "Inside Mt. Moon, you find a rare Pokémon egg!",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/174.png",
        choices: [
          { text: "Take the egg", next: "egg" },
          { text: "Leave it and exit", next: "map" }
        ]
      },
      egg: {
        text: "You carefully take the egg. It might hatch into something amazing.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/174.png",
        choices: [
          { text: "Return to Pallet Town", next: "start" }
        ]
      },
      bulbasaur: {
        text: "Bulbasaur joins your team! Ready for adventure!",
        avatar: animatedSprites.bulbasaur,
        choices: [
          { text: "Continue", next: "start" }
        ]
      },
      charmander: {
        text: "Charmander joins your team! The flame burns bright!",
        avatar: animatedSprites.charmander,
        choices: [
          { text: "Continue", next: "start" }
        ]
      },
      squirtle: {
        text: "Squirtle joins your team! Ready to splash into battle!",
        avatar: animatedSprites.squirtle,
        choices: [
          { text: "Continue", next: "start" }
        ]
      },
      pikachu: {
        text: "Oak smiles and gives you Pikachu! A rare gift!",
        avatar: animatedSprites.pikachu,
        choices: [
          { text: "Continue", next: "start" }
        ]
      },
      leaveLab: {
        text: "You leave the lab without a Pokémon. The journey is yours to choose.",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png",
        choices: [
          { text: "Back to town", next: "start" }
        ]
      },
      catch: {
        text: "You caught Pikachu! Your adventure begins!",
        avatar: animatedSprites.pikachu,
        choices: [
          { text: "Continue", next: "start" }
        ]
      },
      run: {
        text: "You safely return to town. Maybe next time!",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png",
        choices: [
          { text: "Back to town", next: "start" }
        ]
      },
      battle: {
        text: "You battle Pikachu and win! What a fight!",
        avatar: animatedSprites.pikachu,
        choices: [
          { text: "Continue", next: "start" }
        ]
      },
      berries: {
        text: "Pikachu is happy and follows you. A new friend!",
        avatar: animatedSprites.pikachu,
        choices: [
          { text: "Back to town", next: "start" }
        ]
      },
      final: {
        text: "Your Pokémon adventure continues! Explore, battle, and become a champion!",
        avatar: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png",
        choices: [
          { text: "Restart Adventure", next: "start" }
        ]
      }
    };

    const avatarImg = document.getElementById('avatar');
    const storyText = document.getElementById('story-text');
    const choicesDiv = document.getElementById('choices');
    const branchDiv = document.getElementById('branch');
    const bgAudio = document.getElementById('bg-audio');
    const volumeSlider = document.getElementById('volume-slider');

    function loadStoryNode(nodeKey) {
      const node = storyData[nodeKey];
      if (!node) return;

      avatarImg.src = node.avatar;
      avatarImg.alt = "Sprite";
      storyText.textContent = node.text;

      // Clear previous choices
      choicesDiv.innerHTML = '';

      // Create buttons for choices
      node.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.textContent = choice.text;
        btn.setAttribute('role', 'listitem');
        btn.onclick = () => {
          loadStoryNode(choice.next);
          updateBranch(choice.text);
        };
        choicesDiv.appendChild(btn);
      });
    }

    function updateBranch(choiceText) {
      const p = document.createElement('p');
      p.textContent = "You chose: " + choiceText;
      branchDiv.appendChild(p);
      branchDiv.scrollTop = branchDiv.scrollHeight;
    }

    // Initialize game
    loadStoryNode('start');

    // Audio setup
    bgAudio.volume = volumeSlider.value;
    bgAudio.play().catch(() => {
      // Autoplay might be blocked until user interaction
    });

    volumeSlider.addEventListener('input', () => {
      bgAudio.volume = volumeSlider.value;
      volumeSlider.setAttribute('aria-valuenow', volumeSlider.value);
    });
  </script>
</body>
</html>
